(this["webpackJsonptodos-client"]=this["webpackJsonptodos-client"]||[]).push([[0],{31:function(e,t,n){},49:function(e,t,n){},58:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),a=n(15),i=n.n(a),c=(n(31),n(69)),d=n(17),s=n.n(d),u=n.p+"static/media/logo.ca90817f.svg",l=(n(48),n(49),n(11)),j=n(10),b=n(2),f=n(4),h=n(26),O=n(19),v=n(5),g=n(23),p="/api/",m=Object(v.d)({baseUrl:p}),x=Object(v.e)(m,{maxRetries:3}),y="Todo",w="todos",T="/api/auth/google",L=Object(g.a)({reducerPath:"todosApi",baseQuery:x,tagTypes:[y],endpoints:function(e){return{login:e.mutation({query:function(e){return{url:"login",method:"POST",body:e}}}),getTodos:e.query({query:function(){return{url:w}},providesTags:function(e){return e?[].concat(Object(O.a)(e.map((function(e){return{type:"Todo",id:e.id}}))),[{type:y,id:"LIST"}]):[{type:y,id:"LIST"}]}}),addTodo:e.mutation({query:function(e){return{url:w,method:"POST",body:e}},invalidatesTags:[{type:y,id:"LIST"}]}),getTodo:e.query({query:function(e){return"".concat(w,"/").concat(e)},providesTags:function(e,t,n){return[{type:y,id:n}]}}),updateTodo:e.mutation({query:function(e){var t=e.id,n=Object(h.a)(e,["id"]);return{url:"".concat(w,"/").concat(t),method:"PUT",body:n}},invalidatesTags:function(e,t,n){return[{type:y,id:n.id}]}}),deleteTodo:e.mutation({query:function(e){return{url:"".concat(w,"/").concat(e),method:"DELETE"}},invalidatesTags:function(e,t,n){return[{type:y,id:n}]}})}}}),S=L.useAddTodoMutation,N=L.useDeleteTodoMutation,k=(L.useGetTodoQuery,L.useGetTodosQuery),C=(L.useLoginMutation,L.useUpdateTodoMutation),A=(L.endpoints.login,n(8)),D=n.n(A),E=n(13),M=Object(b.c)("user/login",Object(E.a)(D.a.mark((function e(){var t,n;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/auth/me");case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("Not logged in");case 5:if(!(null===(t=n.headers.get("Content-Type"))||void 0===t?void 0:t.toLowerCase().includes("application/json"))){e.next=11;break}return e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 11:throw new Error("Not logged in");case 12:case"end":return e.stop()}}),e)})))),q=Object(b.c)("user/logout",Object(E.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/auth/logout");case 2:return e.abrupt("return",null);case 3:case"end":return e.stop()}}),e)})))),I=Object(b.d)({name:"auth",initialState:{user:null,isAuthenticated:!1,isLoading:!1},reducers:{},extraReducers:function(e){e.addCase(M.pending,(function(e){e.isLoading=!0})).addCase(M.fulfilled,(function(e,t){e.user=t.payload,e.isAuthenticated=!0,e.isLoading=!1})).addCase(M.rejected,(function(e){e.isLoading=!1})).addCase(q.fulfilled,(function(e){e.user=null,e.isAuthenticated=!1}))}}).reducer,U=function(e){return e.auth.isAuthenticated},P=function(e){return e.auth.isLoading},R=function(e){return e.auth.user},z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"todosLocal";localStorage&&localStorage.setItem(t,JSON.stringify(e))},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"todosLocal";try{var t=JSON.parse(localStorage.getItem(e)||"");return t}catch(n){return console.log(n),z([]),[]}},J=G(),W=Object(b.c)("todosLocal/add",function(){var e=Object(E.a)(D.a.mark((function e(t){var n,o;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(j.a)(Object(j.a)({},t),{},{id:Object(b.m)(),isLocal:!0}),(o=G()).push(n),z(o),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Q=Object(b.c)("todosLocal/check",function(){var e=Object(E.a)(D.a.mark((function e(t){var n,o;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=G(),o=n.findIndex((function(e){return e.id===t.id})),n[o].done=!0,z(n),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),B=Object(b.c)("todosLocal/delete",function(){var e=Object(E.a)(D.a.mark((function e(t){var n;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=G(),z(n.filter((function(e){return e.id!==t.id}))),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),F=Object(b.d)({name:"todos",initialState:J,reducers:{},extraReducers:function(e){e.addCase(W.fulfilled,(function(e,t){e.push(t.payload)})).addCase(Q.fulfilled,(function(e,t){var n=e.findIndex((function(e){return e.id===t.payload.id}));e[n].done=!0})).addCase(B.fulfilled,(function(e,t){return e.filter((function(e){return e.id!==t.payload.id}))}))}}).reducer,H=function(e){return e.todos},Y=function(e){return function(e){return function(t){if(Object(b.l)(t)){var n,o,r,a,i,c,d;console.warn("We got a rejected action!",t);var s=null!==(n=null!==(o=null!==(r=null===(a=t.payload)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.message)&&void 0!==r?r:null===(c=t.payload)||void 0===c?void 0:c.error)&&void 0!==o?o:null===(d=t.error)||void 0===d?void 0:d.message)&&void 0!==n?n:"An error occured.";X(s,"danger","Error",3e3,!0,!0)}return e(t)}}},$=function(e){var t;return Object(b.a)(Object(j.a)({reducer:(t={},Object(l.a)(t,L.reducerPath,L.reducer),Object(l.a)(t,"auth",I),Object(l.a)(t,"todos",F),t),middleware:function(e){return e().concat(L.middleware,Y)}},e))}(),K=function(){return Object(f.d)()},V=f.e,X=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Success",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1500,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];d.store.addNotification({id:Object(b.m)(),title:n,message:e,type:t,insert:"bottom",container:"bottom-right",dismiss:{duration:o,onScreen:r,pauseOnHover:a}})},Z=n(12),_=n(24),ee=n.n(_),te=(n(58),n(1)),ne=function(e){var t=e.user,n=e.onLogout;return Object(te.jsxs)("div",{className:"logged-in-view",title:t.email,children:[Object(te.jsx)("div",{className:"user-avatar",children:Object(te.jsx)("img",{src:t.avatar,alt:t.name})}),Object(te.jsxs)("button",{className:"btn-google btn-logout2",onClick:n,children:["Logout as ",t.name]})]})},oe=function(e){var t=e.onClick,n=e.disabled;return Object(te.jsx)("button",{onClick:t,className:"btn-google",disabled:n,children:"Sign in with Google"})},re=function(){var e=V(R),t=V(P),n=K(),r=Object(o.useState)(!1),a=Object(Z.a)(r,2),i=a[0],c=a[1];Object(o.useEffect)((function(){e||n(M())}),[e,n]);var d={features:{toolbar:!1,menubar:!1,width:500,height:700},url:T,name:"Sign in with Google",copyStyles:!1,onUnload:function(){c(!1),n(M())}};return e?Object(te.jsx)(ne,{onLogout:function(){n(q())},user:e}):Object(te.jsxs)(te.Fragment,{children:[Object(te.jsx)(oe,{onClick:function(){window.location.assign(T)},disabled:t}),i&&Object(te.jsx)(ee.a,Object(j.a)({},d))]})};function ae(){var e,t={date:e=new Date,day:Object(c.a)(e,"dd"),dayDisplay:Object(c.a)(e,"d"),month:Object(c.a)(e,"MM"),monthDisplay:Object(c.a)(e,"MMM"),year:Object(c.a)(e,"y"),weekday:Object(c.a)(e,"EEEE")},n=V(U),o=V(P);return Object(te.jsxs)("header",{children:[Object(te.jsx)(s.a,{}),Object(te.jsx)(ie,{}),Object(te.jsxs)("div",{className:"header-container",children:[Object(te.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:"1.5rem"},children:[Object(te.jsx)("div",{style:{margin:"0 10px",fontSize:"5rem"},children:t.dayDisplay}),Object(te.jsxs)("div",{children:[Object(te.jsx)("div",{children:t.monthDisplay}),Object(te.jsx)("div",{children:t.year})]})]}),Object(te.jsx)("div",{children:!o&&!n&&Object(te.jsxs)("p",{style:{fontSize:"1rem"},children:["Your todos are saved in the browser only!",Object(te.jsx)("br",{})," Sign in to save in the database"]})}),Object(te.jsx)("div",{style:{fontSize:"2rem"},children:t.weekday})]})]})}var ie=function(){return Object(te.jsxs)("nav",{className:"navbar",children:[Object(te.jsxs)("div",{className:"logo",children:[Object(te.jsx)("h2",{children:"Awesome Todos"}),Object(te.jsx)("img",{src:u,alt:"Awesome Todos",title:"Awesome Todos"})]}),Object(te.jsx)("div",{children:Object(te.jsx)(re,{})})]})},ce=function(){var e=V(U),t={text:"",done:!1,isLocal:!e},n=Object(o.useState)(t),r=Object(Z.a)(n,2),a=r[0],i=r[1],c=S(),d=Object(Z.a)(c,2),s=d[0],u=d[1].isLoading,b=K();return Object(te.jsx)("div",{className:"row",children:Object(te.jsxs)("form",{onSubmit:function(n){n.preventDefault(),e?s(a).then((function(){return i(t)})):b(W(a)).then((function(){return i(t)}))},className:"todo-form",children:[Object(te.jsx)("input",{type:"text",name:"text",placeholder:"What do you want to do next?",value:a.text,onChange:function(t){var n=t.target;i((function(t){var o;return Object(j.a)(Object(j.a)({},t),{},(o={},Object(l.a)(o,n.name,n.value),Object(l.a)(o,"isLocal",!e),o))}))},required:!0}),Object(te.jsx)("button",{type:"submit",disabled:u,children:u?"Adding...":"Add Todo"})]})})},de=function(e){var t=e.data,n=t.text,o=t.id,r=t.done,a=t.isLocal,i=e.onDone,c=e.onDelete,d=e.isDeleting,s=e.isUpdating,u=["todo-item"];return r&&u.push("checked"),(s||d)&&u.push("pending"),Object(te.jsxs)("li",{className:u.join(" "),children:[Object(te.jsxs)("div",{className:"todo-content",children:[Object(te.jsx)("div",{className:"todo-text",children:n}),Object(te.jsx)("div",{className:"todo-tags",children:a?Object(te.jsx)("div",{className:"todo-local",children:"local"}):Object(te.jsx)(te.Fragment,{})})]}),Object(te.jsxs)("div",{className:"todo-buttons",children:[Object(te.jsx)("button",{onClick:function(){return c(o,a)},title:"Delete",disabled:d,children:d?"\u25fd\u25fd":"\u274c"}),!r&&Object(te.jsx)("button",{onClick:function(){return i(o,!r,a)},title:r?"Mark undone":"Mark done",disabled:s,children:s?"\u25fd\u25fd":"\u2714\ufe0f"})]})]})},se=n(25),ue=n.n(se),le=function(){var e,t,n=V(U),o=K(),r=k(void 0,{skip:!n}),a=r.data,i=r.isLoading,c=r.isError,d=V(H),s=N(),u=Object(Z.a)(s,2),l=u[0],j=u[1],b=j.isLoading,f=j.originalArgs,h=C(),v=Object(Z.a)(h,2),g=v[0],p=v[1],m=p.isLoading,x=p.originalArgs,y=function(e,t,r){var a=function(){X("Todo updated","info")};!n||r?o(Q({id:e})).unwrap().then(a).catch((function(e){return console.log("Local update error",e)})):g({id:e,done:t}).unwrap().then(a).catch((function(e){return console.log("Remote update error",e)}))},w=function(e,t){var r=function(){X("Todo Deleted")};!n||t?o(B({id:e})).unwrap().then(r).catch((function(e){return console.log("Local delete error",e)})):l(e).unwrap().then(r).catch((function(e){return console.log("Remote delete error",e)}))};n?e=(t=null!==a&&void 0!==a?a:[]).concat.apply(t,Object(O.a)(d)):e=d;var T=e.filter((function(e){return e.done})),L=e.filter((function(e){return!e.done}));if(i&&!c)return Object(te.jsx)("div",{className:"todos-loader",children:Object(te.jsx)(ue.a,{color:"#3178c6"})});if(0===e.length)return Object(te.jsx)("div",{style:{textAlign:"center"},children:"No todos! Start by adding some"});var S=function(e){return Object(te.jsx)(de,{data:e,onDelete:w,onDone:y,isDeleting:b&&f===e.id,isUpdating:m&&(null===x||void 0===x?void 0:x.id)===e.id},e.id)};return Object(te.jsxs)("div",{children:[!n&&Object(te.jsx)("h2",{children:"Local todos"}),Object(te.jsx)("ul",{className:"todo-list",children:L.map(S)}),T.length>0&&Object(te.jsxs)("div",{style:{marginTop:"1rem"},children:[Object(te.jsx)("h2",{children:"Completed"}),Object(te.jsx)("ul",{className:"todo-list",children:T.map(S)})]})]})},je=(n(65),function(){var e=V(P);return Object(te.jsxs)("main",{children:[Object(te.jsx)(ce,{}),Object(te.jsxs)("div",{className:"todo-list-wrapper",children:[e&&Object(te.jsx)("p",{children:"Loading"}),!e&&Object(te.jsx)(le,{})]})]})});var be=function(){return Object(te.jsxs)("div",{className:"App",children:[Object(te.jsx)(ae,{}),Object(te.jsx)(je,{})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(te.jsx)(r.a.StrictMode,{children:Object(te.jsx)(f.a,{store:$,children:Object(te.jsx)(be,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[66,1,2]]]);
//# sourceMappingURL=main.2b7da59e.chunk.js.map